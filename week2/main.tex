%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage[usenames,dvipsnames]{color} % Required for custom colors
\usepackage{graphicx} % Required to insert images
\usepackage{listings} % Required for insertion of code
\usepackage{caption}
\usepackage{courier} % Required for the courier font
\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template
\usepackage{titlesec}

% My addon
\renewcommand{\thepage}{\Roman{page}}% Roman numerals for page counter
\usepackage{fontspec}   %加這個就可以設定字體
\usepackage{xeCJK}       %讓中英文字體分開設置
\setmainfont{Arial}
\setCJKmainfont{思源黑體} %設定中文為系統上的字型，而英文不去更動，使用原TeX字型
\XeTeXlinebreaklocale "zh"             %這兩行一定要加，中文才能自動換行
\XeTeXlinebreakskip = 0pt plus 1pt     %這兩行一定要加，中文才能自動換行

% \def\footnotesize{\fontsize{16}{24}\selectfont}
\def\small{\fontsize{10}{15}\selectfont}
\def\normalsize{\fontsize{12}{16}\selectfont}
\def\large{\fontsize{16}{24}\selectfont}
\def\Large{\fontsize{20}{30}\selectfont}
\def\LARGE{\fontsize{24}{36}\selectfont}
\def\huge{\fontsize{32}{48}\selectfont}
\def\Huge{\fontsize{36}{54}\selectfont}

% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1} % Line spacing

% Set up the header and footer
\pagestyle{fancy}
\lhead{\hmwkTitle} % Top left header
% \chead{\hmwkClass\ (\hmwkClassInstructor\ \hmwkClassTime): \hmwkTitle} % Top center head
\rhead{\hmwkClass} % Top right header
% \lfoot{\lastxmark} % Bottom left footer
\cfoot{\thepage} % Bottom center footer
% \rfoot{Page\ \ of\ \protect\pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
% \renewcommand\footrulewidth{0.4pt} % Size of the footer rule

\setlength\parindent{0pt} % Removes all indentation from paragraphs

%----------------------------------------------------------------------------------------
%	CODE INCLUSION CONFIGURATION
%----------------------------------------------------------------------------------------
 
% \definecolor{MyDarkGreen}{rgb}{0.0,0.4,0.0} % This is the color used for comments
% \lstloadlanguages{C++} % Load Perl syntax for listings, for a list of other languages supported see: ftp://ftp.tex.ac.uk/tex-archive/macros/latex/contrib/listings/listings.pdf
% \lstset{language=Matlab, % Use Perl in this example
%         frame=tB, % Single frame around code
%         basicstyle=\normalsize, % Use small true type font
%         % keywordstyle=[1]\color{Blue}\bf, % Perl functions bold and blue
%         % keywordstyle=[2]\color{Purple}, % Perl function arguments purple
%         % keywordstyle=[3]\color{Blue}\underbar, % Custom functions underlined and blue
%         keywordstyle=\color{black}\bfseries\em,
%         keywords={input, output, return, datatype, function, in, if, else, foreach, while, begin, end}, %add the keywords you want, or load a language as Rubens explains in his comment above.
%         identifierstyle=, % Nothing special about identifiers                                         
%         commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small, % Comments small dark green courier font
%         stringstyle=\color{Purple}, % Strings are purple
%         showstringspaces=false, % Don't put marks in string spaces
%         tabsize=4, % 5 spaces per tab
%         %
%         % Put standard Perl functions not included in the default language here
%         morekeywords={rand},
%         %
%         % Put Perl function parameters here
%         morekeywords=[2]{on, off, interp},
%         %
%         % Put user defined functions here
%         morekeywords=[3]{test},
%        	%
%         morecomment=[l][\color{Blue}]{...}, % Line continuation (...) like blue comment
%         numbers=left, % Line numbers on left
%         firstnumber=1, % Line numbers start with line 1
%         numberstyle=\normalsize, % Line numbers are blue and small
%         stepnumber=1 % Line numbers go in steps of 5
% }

% Creates a new command to include a perl script, the first parameter is the filename of the script (without .pl), the second parameter is the caption
% \newcommand{\algorithmscript}[2]{
% \begin{itemize}
% \item[]\lstinputlisting[caption=#2,label=#1]{#1.NB}
% \end{itemize}
% }

\newcounter{nalg} % defines algorithm counter for chapter-level
\DeclareCaptionLabelFormat{algocaption}{\normalsize\bf Algorithm \thenalg} % defines a new caption label as Algorithm x.y

\lstnewenvironment{algorithm}[1][] %defines the algorithm listing environment
{   
    \refstepcounter{nalg} %increments algorithm number
    \captionsetup{labelformat=algocaption,labelsep=colon} %defines the caption setup for: it ises label format as the declared caption label above and makes label and caption text to be separated by a ':'
    \lstset{ %this is the stype
        frame=tB,
        numbers=left, 
        numberstyle=\normalsize,
        basicstyle=\normalsize, 
        keywordstyle=\color{black}\bfseries\em,
        keywords={,input, output, return, datatype, function, in, if, else, foreach, while, begin, end, } %add the keywords you want, or load a language as Rubens explains in his comment above.
        numbers=left,
        xleftmargin=.04\textwidth,
        #1 % this is to add specific settings to an usage of this environment (for instnce, the caption and referable label)
    }
}
{}

%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{培訓-2} % Assignment title
\newcommand{\hmwkDueDate}{2015年9月23日（火曜日）} % Due date
\newcommand{\hmwkClass}{併查集と狀態空間搜索} % Course/class
\newcommand{\hmwkClassTime}{TTD} % Class/lecture time
\newcommand{\hmwkClassInstructor}{TT} % Teacher/lecturer
\newcommand{\hmwkAuthorName}{FruitTea} % Your name


%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title{\hmwkClass}
\author{\hmwkAuthorName}
\date{\hmwkDueDate}

%----------------------------------------------------------------------------------------

\begin{document}
\LARGE~\\[4ex]
\centerline{\bf\hmwkClass}\large\\[2ex]\centerline{\hmwkAuthorName}\\[2ex]\centerline{\hmwkDueDate}\\
\normalsize

\section{Disjoint Sets 互斥集}
\subsection*{Introduction}
Disjoint Sets，又稱互斥集，代表一群集合兩兩交集皆為空集合的狀況，常常用來處理「分類」問題。
因為功能實用、實作簡單，在資訊競賽中很常被使用。\\
實作Disjoint Sets的資料結構我們可以稱她為併查樹(Union-find Tree)或是併查森林(很多棵樹嚴格上來說要叫做森林)。
基本上我們會以一顆併查樹代表一個集合。\\
一個基本的併查樹我們必須實作兩種操作，Find 和 Union。

\subsection{Find 查詢}
我們有一個陣列 P[x] 代表 x 的 parent 是誰，如果 x 是併查樹的樹根(root)，我們就把 x 的 parent 當作是自己。
初始狀態下所有的 P[x] = x 。(一開始大家都屬於各自不同的集合)\\
如果我們想要知道 x 在哪個集合中(x 的 root 是誰)，我們只要遞迴 P[x] 就可以得到答案了。

\begin{algorithm}[caption={Find}, label={alg1}]
function Find(x)
    if x ≠ p[x] then
        return Find(p[x])
    else
        return x
    end if
end function
\end{algorithm}

可是這樣每次找一個點，最慘的狀況下可能會花 O(N) 的時間，所以我們引入一個稱為"Path Compression"的概念，
速度可以快非常多。\\
Path Compression 其實就是在遞迴的過程中，讓所有路徑上的點「直接」連到root。代碼如下。

\begin{algorithm}[caption={Find \& Path Compression}, label={alg1}]
function Find(x)
    if x ≠ p[x] then
        p[x] ← Find(p[x])
        return Find(p[x])
    else
        return x
    end if
end function
\end{algorithm}

\subsection{Union 合併}
想要合併兩個集合，也就是合併兩顆併查樹，只要把A樹的樹根接到B樹的樹根就可以了。

\begin{algorithm}[caption={Union}, label={alg1}]
function Union(x, y)
    p[Find(x)] ← Find(y)
end function
\end{algorithm}

合併上也有一個優化的方法叫做"Union By Rank"，也就是把小樹合併到大樹上，這樣需要更動的點會比較少。\\

\subsection{總結}
併查樹可以讓我們在處理分類和合併的問題時很輕鬆的完成。如果我們同時使用"Union By Rank"和"Path Compression"，
併查樹的複雜度是 O(N × α(N))，其中 α(N) 是阿克曼函數的反函數。不過就算不用"Union By Rank"，
複雜度也只是退化到 O(N × lg N)，在競賽領域中，我們會遇到的併查樹的操作， α(N) 和 lg N 都不會太大，
所以基本上我們可以把併查樹的複雜度當作 O(N) 來使用。至於"Union By Rank"對於併查樹來說會比較麻煩(需要多紀錄rank)又不會快很多，所以平常不太需要。

\subsection{Exercises!!}

\begin{description}
\item[ 1.]<TIOJ 1312 家族>\\
給你很多組數字 a, b，代表 a 與 b 在同個家族。
現在給你一個數字 k，求 k 所在的家族中編號最小的是誰?
\item[ 2.]<POJ 2492 雌蟲雄蟲>\\
給你很多對關係 x, y，代表蟲 x 跟蟲 y 性別不一樣。
請輸出這些條件是否有任何矛盾 (也就是有蟲為雌雄同體，ex:(x, y)、(y, z)、(z, x))。
\item[ 3.]<POJ 1182 食物鏈>\\
總共有 A、B、C 三種天使，A 吃 B，B 吃 C，C 吃 A。
依序給你很多組關係 d, x, y，若 d = 1 則代表天使 x 跟 y 是同類，d = 2 則代
表天使 x 吃 y。
若當前給的關係與之前的關係矛盾，代表此組關係是假的。
求總共有多少組關係是假的？
\item[ 4.]<TIOJ 1833 陽炎眩亂>\\
有一群蘿莉機器人，分成很多部隊，每個部隊都有一個女王。
題目可能要求你合併兩個部隊或是查詢某隻蘿莉機器人隸屬於哪個女王。
\end{description} 


\section{Search 搜尋}
\subsection*{Introduction}
搜索，暴力的找答案，也就是要試過每個可能性後再一個一個檢查。
雖然是暴力，但是寫法好或不好差別還是很大的喔！

\subsection{Enumeration 枚舉}
嘗試所有的可能，然後一一檢查，找出答案。

\subsection{State Space Search 狀態空間搜索}
先把問題轉成某種狀態，比如你要去學校上學，一開始在位置(0, 0) 要到位置(s, t)。現在的位置即為狀態。\\
至於從(0, 0) 到 (0, 1) 就稱為狀態轉移，
比如南海路也許就是一條可以讓你從家裡轉移到學校的其中一個狀態轉移的路徑。\\
所有的狀態的集合就是狀態空間，在這裡面找答案就是所謂的狀態空間搜索。\\
我們並不知道這個稱之為狀態空間的迷宮長怎麼樣，所以我們必須嘗試走走看，至於怎麼走才有效率，
我們介紹幾個常見的演算法。

\subsection{DFS}
Depth First Search(深度優先搜索)，簡稱DFS。也就是一直往前走，
直到遇到死路就往後退到上一個岔路並且換一條走，如果所有岔路都走完了就再往後退，直到把所有的點都搜完。
跟著下圖的編號順序走訪一遍就是一個DFS順序的搜尋，當然大家的順序可能不太一樣。\\
\includegraphics[width=0.5\columnwidth]{DFS.png}\\
實作上，我們只要用遞迴就可以輕鬆完成，也可以用Stack模擬，可是很麻煩。並且注意一定要記的紀錄走過的點。
\begin{algorithm}[caption={DFS}, label={alg1}]
function DFS(v)
    mark v as visited
    for all u that is adjacent to v do
        if u is not visited then
            DFS(u)
        end if
    end for
end function
\end{algorithm}

\subsection{BFS}
Breadth First Search(廣度優先搜索)，簡稱BFS，也就是所謂的地毯式搜索。
一層一層的向外擴大搜尋範圍，就像下圖的順序，直到走完所有點。
當然你不可能一次走到很多點，所以下圖的數字代表層數，至於同一層的順序大家可能會不太一樣。
有一個很棒的性質是，BFS的層數剛好就是起點到該點的距離。\\
\includegraphics[width=0.5\columnwidth]{BFS.png}\\
實作BFS也很簡單，只要把DFS的Stack換成Queue就可以了。
\begin{algorithm}[caption={BFS}, label={alg1}]
function BFS(v)
    enqueue v to Q (Q is a queue)
    mark v as visited
    while Q is not empty do
        c ← pop Q
        for all u that is adjacent to c do
            if u is not visited then
                push u to Q
                mark u as visited
            end if
        end for
    end while
end function
\end{algorithm}

\subsection{BiBFS}
雙向的BFS，通常是在知道起點和終點而要找最短路徑時，同時交錯在起點和終點做BFS，起點做一層，終點跟著做一層。
當一個點同時被起點和終點搜到時，我們可以確定一定有一條最短路徑，從起點經過這個點到終點。\\
BiBFS的好處是，一般BFS必須不斷把點存進記憶體裡，假設每個點都連到N個點，那麼距離 d 的BFS就必須存入O($N^d$)個點。
但是，用BiBFS我們兩個BFS的距離都剩下 $d \over 2$，所以只要存 O($N^{d \over 2}$)個點，省下了不少記憶體。

\subsection{IDDFS}
IDDFS就是限制深度的DFS，先做一個限制深度的DFS，然後不斷加深深度。
這樣做的原因是避免我們走進一個又深又長的死路，白白浪費時間。
因為限制了深度，到達終點時，深度剛好可以代表距離。\\
也許你會覺得這樣一直重複走走過的點很浪費時間，但是從時間複雜度去分析，
假設每個點都連到N個點，1~d層點數總共有O($N^{d+1}$)，
而d+1層卻也有O($N^{d+1}$)個點，所以總共只差了常數時間而已。\\
換句話說，IDDFS就是一個不會浪費空間的BFS，但是比BFS難寫，不過時間複雜度不變。

\subsection{A*}
A*就是把BFS裡的queue換成priority queue，也就是依照優先度去搜尋，而不是到起點的實際距離。
至於優先度是甚麼呢，其實可以自己定義。A*的優先度是起點到終點的估計距離，也就是我們希望最短路徑優先被搜尋到。\\
我們給每一點一個優先度 f(x) = g(x) + h(x)，其中g(x)代表起點到該點的實際距離，h(x)代表該點到終點的估計距離。
我們只要挑f(x)最小的人先走，很快就可以找到最短路徑。\\
不過這樣真的會是最短路徑嗎？
我們可以證明，因為我們不會高估h(x)，也就是我們只要保證該點到終點的實際距離大於等於 h(x)，
這樣的話如果我們由一條路徑A走到終點，另外一條 f(x)比這條路徑大的路徑B，實際距離一定比路徑B的f(x)更大，
所以路徑A就是最短路徑了。

\subsection{IDA*}
IDA*就是IDDFS加上A*，也就是限制f(x)的長度。
當我們做IDDFS時，深度(剛好就是A*裡提到的g(x))超過限制就砍掉。
現在我們一樣做IDDFS，只是改成f(x)超過長度限制就砍掉(也就是不用g(x)超過限制，如果估計長度超過就可以先砍掉了。)\\
因為我們保證到終點的實際長度大於等於h(x)，所以我們不會不小心砍掉可以走的路徑。

\subsection{總結}
搜尋其實是很神秘又很吃人品的領域，透過簡單的DFS、BFS去拓展，想辦法剪枝(就像IDA*)，
或是利用一些性質，甚至Random一下，都有機會降低複雜度。\\
之後還會介紹一堆神奇的狀態空間搜索，基本上所有的問題都可以透過搜索解出來，
把搜索學好可以幫助你解決很多無論是競賽還是生活上的問題。
(ex：遊戲中的bot走路可以用A*解決，算高維度函數可以用爆搜剪枝驗算答案等等。)\\
附註：因為台灣的比賽很雷，常常演算法比賽會變成爆搜比賽，練好搜尋絕對是好處多於壞處的。

\subsection{Exercises!!}
\begin{description}
\item[ 1.]<TIOJ 1025 數獨問題>\\
計算數獨的答案。
\item[ 2.]<TIOJ 1573 15-puzzle>\\
給你一個 4*4 的盤面，裡面有 1 ～ 15 跟一個空格，
你每次可以將一個與空格相鄰的數字移到空格上，問最少要幾步才能移動成到指定的盤面。
\item[ 3.]<SGU 149 Computer Network>\\
給你一棵樹，問樹的直徑（任兩點最大距離）。（N <= 1000000）
\item[ 4.]<SGU 125 Shtirlits>\\
有一個 N × N 矩陣 A，每一個數字都介於 0 ～ 9，他給你另一個 N × N 矩陣 B，
Bij 代表 Aij 的周圍有幾個比他大的數字。請輸出任一個可行的矩陣 A，
若不存在，則輸出"NO SOLUTION"。（N <= 3）
\item[ 5.]<經典問題>\\
給一個 M × N 的格子矩形，每個格子不是 1 就是 0，你每次可以對一個格子進行操作，
把那個格子和他周圍的格子 1 變成 0、0 變成 1，問你至少要做幾次才能使所有格子都變成 0。(M, N ≤ 15)
\item[ 6.]<TIOJ 1099 射手座之日>\\
對一個三維空間的座標 (x, y, z)，你可以做它兩件事：\\
(a) 把 x, y, z 任意調換\\
(b) 把 (x, y, z) 變成 (2y－x＋1, 2x－y－1, z)\\
問有沒有可能把座標從 (x1, y1, z1) 變成 (x2, y2, z2)。
\item[ 7.]<TIOJ 1022 跑跑卡恩車>\\
有一個高低起伏的地圖，你可以在高度差不超過5的格子之間移動。
請問從起點到終點最短要走多遠。
\item[ 8.]<TIOJ 1013 Fire in the forest>\\
在一張給定的地圖中，給你不同的起點和終點，還有一個起火點，
你的速度和火的速度一樣，而火會不斷向四個方向延燒。
請問你來得急在被火燒到前跑到終點嗎？
\item[ 9.]<TIOJ 1226 H遊戲>\\
給你一個有向無環圖，問你從起點到每個終點的所有可能的路徑的路徑長和。
\item[ 10.]<TIOJ 1250 番茄蹲>\\
有N個人排成一排，一開始都站著，主持人可以選擇一個數字k，使k的倍數編號的人蹲下，如果已經蹲下就站起來。
請你列出經過M個回合後所有可能的狀況。
\end{description}


\end{document}